#!/bin/bash

aws ec2 run-instances \
    --image-id ami-0568936c8d2b91c4e \
    --instance-type t2.micro \
    --subnet-id subnet-013affb718a597ad0 \
    --security-group-ids sg-04238434d4aef20c6 \
    --key-name awesome-key \
    --query 'Instances[*].InstanceId' \
    --output text \
| xargs -I {} aws ec2 describe-instances \
    --instance-ids {} \
    --query 'Reservations[*].Instances[*].PublicIpAddress' \
    --output text